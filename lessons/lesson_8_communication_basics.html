<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Communication Basics | The Robotics Institute</title>
    <!-- Copy all the styles from intro-to-robotics.html -->
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #faf9f6;
            color: #292929;
            line-height: 1.6;
        }

        .nav-bar {
            padding: 1rem 2rem;
            background-color: #ffffff;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-sizing: border-box;
            border-bottom: 1px solid #e6e6e6;
        }

        .nav-bar a {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            color: #292929;
            text-decoration: none;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .article-container {
            max-width: 800px;
            margin: 80px auto 0;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .article-header {
            margin-bottom: 3rem;
        }

        .article-title {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            font-size: 2.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            line-height: 1.3;
            color: #292929;
        }

        .article-meta {
            color: #666;
            font-size: 0.95rem;
            font-style: italic;
        }

        .article-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #292929;
        }

        .article-content p {
            margin-bottom: 3rem;
        }

        .article-content h3 {
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
            font-weight: 500;
        }

        .image-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .image-item {
            text-align: center;
        }

        .image-item img {
            width: 100%;
            max-width: 300px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .short-caption {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #666;
            font-style: italic;
        }

        .extended-caption {
            text-align: center;
            margin: 1rem 0 2rem;
            color: #666;
            font-size: 0.95rem;
        }

        .image-text-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
            align-items: center;
        }

        .image-text-container.reverse {
            direction: rtl;
        }

        .image-text-container.reverse > * {
            direction: ltr;
        }

        .side-image {
            width: 100%;
            max-width: 300px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .media-container {
            text-align: center;
            margin: 2rem 0;
        }

        .media-container img,
        .media-container video {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .caption {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #666;
            font-style: italic;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            color: #2b6cb0;
            cursor: help;
            border-bottom: 1px dotted #2b6cb0;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Custom tooltip colors for specific terms */
        .tooltip.transistor {
            color: #8b5cf6;
            border-bottom-color: #8b5cf6;
        }

        .tooltip.transistor:hover {
            color: #a78bfa;
            border-bottom-color: #a78bfa;
        }

        .tooltip.capacitor {
            color: #f59e0b;
            border-bottom-color: #f59e0b;
        }

        .tooltip.capacitor:hover {
            color: #fbbf24;
            border-bottom-color: #fbbf24;
        }

        /* Interactive Tool Styles */
        .interactive-tool {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 2rem;
            margin: 3rem 0;
            box-shadow: 
                0 8px 32px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
        }

        .interactive-tool::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #00d4ff, #0099cc, #00d4ff);
            background-size: 200% 100%;
            animation: scan-line 3s ease-in-out infinite;
        }

        @keyframes scan-line {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .interactive-tool h4 {
            color: #00d4ff;
            font-size: 1.4rem;
            margin-bottom: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
            font-family: 'Courier New', monospace;
        }

        .tool-description {
            color: #e2e8f0;
            font-size: 1rem;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .tool-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-radius: 8px;
            border: 1px solid #718096;
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .tool-controls label {
            font-weight: 500;
            color: #ffffff;
            font-size: 0.95rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .slider {
            width: 200px;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #2b6cb0;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #2b6cb0;
            cursor: pointer;
            border: none;
        }

        .signal-input {
            padding: 0.5rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            width: 120px;
        }

        .reconstruction-select {
            padding: 0.5rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            background-color: #ffffff;
            font-size: 0.9rem;
            cursor: pointer;
        }

        /* Pause Button */
        .pause-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background-color: #2b6cb0;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .pause-btn:hover {
            background-color: #1e40af;
        }

        .pause-btn.paused {
            background-color: #38a169;
        }

        .pause-btn.paused:hover {
            background-color: #2f855a;
        }

        .pause-btn .play-icon {
            display: none;
        }

        .pause-btn.paused .pause-icon {
            display: none;
        }

        .pause-btn.paused .play-icon {
            display: inline;
        }

        .canvas-container {
            text-align: center;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-radius: 8px;
            border: 2px solid #4a5568;
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            position: relative;
        }

        .canvas-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #00d4ff, #0099cc, #00d4ff);
            border-radius: 8px 8px 0 0;
        }

        .canvas-container canvas {
            border: 2px solid #4a5568;
            border-radius: 6px;
            max-width: 100%;
            height: auto;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        .tool-explanation {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border: 1px solid #718096;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .tool-explanation p {
            margin-bottom: 1rem;
            color: #ffffff;
            line-height: 1.7;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .tool-explanation ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .tool-explanation li {
            margin-bottom: 0.5rem;
            color: #ffffff;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .tool-explanation strong {
            color: #00d4ff;
            text-shadow: 0 0 8px rgba(0, 212, 255, 0.3);
        }

        /* What is it literally section */
        .what-is-it-section {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border: 1px solid #718096;
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0 0 0;
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            position: relative;
        }

        .what-is-it-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #00d4ff, #0099cc, #00d4ff);
            border-radius: 8px 8px 0 0;
        }

        .what-is-it-section h4 {
            color: #00d4ff;
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
            font-family: 'Courier New', monospace;
        }

        .what-is-it-section .image-text-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: center;
        }

        .what-is-it-section .side-image {
            width: 100%;
            max-width: 300px;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            border: 2px solid #4a5568;
        }

        .what-is-it-section .text-side p {
            color: #ffffff;
            font-size: 1rem;
            line-height: 1.7;
            margin: 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        /* Canvas Legend */
        .canvas-legend {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-radius: 8px;
            border: 1px solid #718096;
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            flex-wrap: wrap;
            align-items: center;
        }

        .legend-box {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            background: linear-gradient(135deg, #ffffff 0%, #f7fafc 100%);
            border-radius: 6px;
            border: 1px solid #cbd5e0;
            box-shadow: 
                0 2px 8px rgba(0,0,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.8);
            transition: all 0.3s ease;
            position: relative;
            flex-shrink: 0;
            min-width: 0;
        }

        .legend-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #00d4ff, #0099cc);
            border-radius: 6px 6px 0 0;
        }

        .legend-box:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.15),
                inset 0 1px 0 rgba(255,255,255,0.9);
            border-color: #00d4ff;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .legend-text {
            color: #4a5568;
            font-size: 0.85rem;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 120px;
        }

        /* Responsive design for smaller screens */
        @media (max-width: 768px) {
            .tool-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            
            .slider {
                width: 100%;
            }
            
            .signal-input {
                width: 100%;
            }
            
            .canvas-container canvas {
                width: 100%;
                max-width: 500px;
            }
            
            .canvas-legend {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .legend-box {
                justify-content: center;
                max-width: none;
            }
            
            .legend-text {
                max-width: none;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <a href="../index.html">← Back to Home</a>
    </nav>

    <article class="article-container">
        <header class="article-header">
            <h1 class="article-title">Communication Basics</h1>
            <div class="article-meta">
                Written by Nathan Daniel • Last updated Jan 2025
            </div>
        </header>

        <div class="article-content">
            <p>
                We’ve mapped out a robot’s muscles, eyes, and a bit of the brain, so let’s get into how these parts talk to one another. Electronics, unsurprisingly, communicate with signals made of <i>electricity</i>. These electrical signals are just voltages going up or down and usually come in one of two “languages.”
            </p>

            <p>
                The first is <b>digital</b>, which consists of clean on/off steps, like flipping a light switch up or down. The other is <b>analog</b>, a continuous signal that can vary in many ways — more like a <span class="tooltip">dimmer switch<span class="tooltiptext">the brits call these 'dip switches', and it's that sort of linguistic tomfoolery that made us rebel.</span></span> that can change brightness via a slider.
            </p>

            <div class="media-container" style="text-align: center;">
                <img src="../imgs/lesson_8_digital_analog.png" alt="analog digital"
                  style="width: 100%; max-width: 500px;">
              </div>

            <p>
                Think of it like comparing <b>whistling</b> to <b>Morse code</b>. With whistling, you can slide smoothly up and down in pitch and carry unique messages based on the sound at that exact moment (analog). With Morse code, you build a common language out of just two simple values: short and long (digital).
            </p>

            <p>
                Most modern robots rely on digital signals because they’re less prone to <b>noise</b>, or any unwanted signal that interferes with the real one, causing distortion or errors. But you’ll still find plenty of analog sensors out there. The truth is, robots often live in both worlds at once: a sensor might output a smooth, analog voltage but the robot’s computer only understands neat digital steps. To bridge that gap, we use special translators called <b>ADCs (Analog-to-Digital Converters)</b> and <b>DACs (Digital-to-Analog Converters)</b>. They act as the bouncer to let continuous real-world signals talk to the robot’s digital brain, and vice versa.

            </p>

            
            <p>
                Let's visualize how these conversions actually work. The tools below demonstrate the fundamental concepts of sampling and reconstruction that make digital communication possible.
            </p>

            <!-- ADC Visualizer -->
            <div class="interactive-tool">
                <h4>ADC Visualizer: Goin from Analog → Digital</h4>
                
                <div class="tool-explanation">
                    <p><strong>What's happening here?</strong></p>

                    <p>
                        An ADC (Analog-to-Digital Converter) takes a smooth, continuous analog signal and chops it into snapshots that a computer can understand as digital numbers. The <b>sampling rate</b> is how often those snapshots are taken.
                    </p>

                    <p>
                        At low sampling rates, the digital version looks choppy and can even misrepresent the original signal (aliasing). At high sampling rates, the digital signal starts to closely match the analog one. That’s why the sampling rate is important for things like audio, video, and robot sensors!
                    </p>
                </div>
                
                <div class="tool-controls">
                    <label for="adc-sampling-rate">Sampling Rate: <span id="adc-rate-display">10</span> Hz</label>
                    <input type="range" id="adc-sampling-rate" min="1" max="50" value="10" class="slider">
                    <button id="adc-pause-btn" class="pause-btn">
                        <span class="pause-icon">⏸</span>
                        <span class="play-icon">▶</span>
                        Pause
                    </button>
                </div>
                
                <div class="canvas-legend">
                    <div class="legend-box blue">
                        <div class="legend-color">
                            <svg width="16" height="16" viewBox="0 0 16 16">
                                <line x1="2" y1="8" x2="14" y2="8" stroke="#2b6cb0" stroke-width="3" stroke-linecap="round"/>
                            </svg>
                        </div>
                        <div class="legend-text">
                            <strong>Blue line:</strong> Original analog signal
                        </div>
                    </div>
                    <div class="legend-box red">
                        <div class="legend-color">
                            <svg width="16" height="16" viewBox="0 0 16 16">
                                <circle cx="8" cy="8" r="4" fill="#e53e3e"/>
                            </svg>
                        </div>
                        <div class="legend-text">
                            <strong>Red dots:</strong> Sample points
                        </div>
                    </div>
                    <div class="legend-box green">
                        <div class="legend-color">
                            <svg width="16" height="16" viewBox="0 0 16 16">
                                <path d="M2 8 L6 8 L6 4 L10 4 L10 8 L14 8" stroke="#38a169" stroke-width="2" fill="none" stroke-linecap="round"/>
                            </svg>
                        </div>
                        <div class="legend-text">
                            <strong>Green steps:</strong> Digital output
                        </div>
                    </div>
                </div>
                
                <div class="canvas-container">
                    <canvas id="adc-canvas" width="600" height="300"></canvas>
                </div>

                <!-- What is it literally section -->
                <div class="what-is-it-section">
                    <h4>What is it literally?</h4>
                    <div class="image-text-container">
                        <div class="image-side">
                            <img src="../imgs/lesson_8_adc.jpg" alt="ADC circuit diagram" class="side-image">
                        </div>
                        <div class="text-side">
                                                    <p>
                            It's not actually a graph, but a real circuit made of <span class="tooltip transistor">transistors<span class="tooltiptext">A tiny electronic switch that can turn current on or off (or amplify it), and is the basic building block of modern circuits.</span></span> and <span class="tooltip capacitor">capacitors<span class="tooltiptext">An electrical "storage tank" that temporarily holds and releases energy, like a tiny rechargeable bucket!</span></span>, usually packaged as a tiny chip. Sometimes it's a standalone part you wire up, other times it's built directly into your robot's microcontroller so you don't even see it. Either way, its whole job is to sit between the analog world (smooth voltages from sensors) and the digital world (numbers your robot's brain can process) and act as the translator.
                        </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DAC Visualizer -->
            <div class="interactive-tool">
                <h4>DAC Visualizer: Digital → Analog</h4>
                
                <div class="tool-explanation">
                    <p><strong>What's happening here?</strong></p>

                    <p>
                        A DAC (Digital-to-Analog Converter) does the opposite of an ADC - it takes digital numbers and reconstructs them into a smooth, continuous analog signal. The <b>reconstruction type</b> determines how smooth that output becomes.
                    </p>

                    <p>
                        Basic reconstruction gives you blocky, step-like output that's simple but can sound harsh. Filtered reconstruction smooths out those steps to create natural-sounding curves. This is how your digital music gets converted back into the smooth sound waves that come out of your speakers!
                    </p>
                </div>
                
                <div class="tool-controls">
                    <label for="dac-signal">Digital Signal:</label>
                    <input type="text" id="dac-signal" value="101010" class="signal-input" placeholder="Enter 1s and 0s">
                    <label for="dac-reconstruction">Reconstruction Type:</label>
                    <select id="dac-reconstruction" class="reconstruction-select">
                        <option value="basic">Basic (Blocky)</option>
                        <option value="filtered">Filtered (Smooth)</option>
                    </select>
                </div>
                
                <div class="canvas-legend">
                    <div class="legend-box blue">
                        <div class="legend-color">
                            <svg width="16" height="16" viewBox="0 0 16 16">
                                <rect x="2" y="4" width="4" height="8" fill="#2b6cb0"/>
                                <rect x="10" y="4" width="4" height="8" fill="#2b6cb0"/>
                            </svg>
                        </div>
                        <div class="legend-text">
                            <strong>Blue bars:</strong> Digital signal
                        </div>
                    </div>
                    <div class="legend-box red">
                        <div class="legend-color">
                            <svg width="16" height="16" viewBox="0 0 16 16">
                                <path d="M2 8 Q8 2 14 8" stroke="#e53e3e" stroke-width="2" fill="none" stroke-linecap="round"/>
                            </svg>
                        </div>
                        <div class="legend-text">
                            <strong>Red line:</strong> Analog output
                        </div>
                    </div>
                </div>
                
                <div class="canvas-container">
                    <canvas id="dac-canvas" width="600" height="300"></canvas>
                </div>
            </div>
        </div>
    </article>

    <script>
        // ADC Visualizer
        class ADCVisualizer {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.samplingRate = 10;
                this.time = 0;
                this.animationId = null;
                this.isPaused = false;
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.animate();
            }
            
            setupEventListeners() {
                const slider = document.getElementById('adc-sampling-rate');
                const display = document.getElementById('adc-rate-display');
                const pauseBtn = document.getElementById('adc-pause-btn');
                
                slider.addEventListener('input', (e) => {
                    this.samplingRate = parseInt(e.target.value);
                    display.textContent = this.samplingRate;
                });
                
                pauseBtn.addEventListener('click', () => {
                    this.togglePause();
                });
            }
            
            animate() {
                if (!this.isPaused) {
                    this.time += 0.02;
                }
                this.draw();
                this.animationId = requestAnimationFrame(() => this.animate());
            }
            
            togglePause() {
                this.isPaused = !this.isPaused;
                const pauseBtn = document.getElementById('adc-pause-btn');
                
                if (this.isPaused) {
                    pauseBtn.classList.add('paused');
                    pauseBtn.innerHTML = '<span class="play-icon">▶</span>Play';
                } else {
                    pauseBtn.classList.remove('paused');
                    pauseBtn.innerHTML = '<span class="pause-icon">⏸</span>Pause';
                }
            }
            
            draw() {
                const ctx = this.ctx;
                const width = this.canvas.width;
                const height = this.canvas.height;
                const centerY = height / 2;
                
                // Clear canvas
                ctx.clearRect(0, 0, width, height);
                
                // Draw grid
                this.drawGrid();
                
                // Draw analog signal (sine wave)
                ctx.strokeStyle = '#2b6cb0';
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                for (let x = 0; x < width; x++) {
                    const t = (x / width) * 4 * Math.PI + this.time;
                    const y = centerY + Math.sin(t) * 80;
                    if (x === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();
                
                // Calculate and draw sample points
                const samples = [];
                const sampleInterval = width / (this.samplingRate * 2);
                
                for (let i = 0; i <= this.samplingRate * 2; i++) {
                    const x = i * sampleInterval;
                    if (x < width) {
                        const t = (x / width) * 4 * Math.PI + this.time;
                        const y = centerY + Math.sin(t) * 80;
                        samples.push({x, y});
                        
                        // Draw sample point
                        ctx.fillStyle = '#e53e3e';
                        ctx.beginPath();
                        ctx.arc(x, y, 4, 0, 2 * Math.PI);
                        ctx.fill();
                    }
                }
                
                // Draw digital reconstruction
                ctx.strokeStyle = '#38a169';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                for (let i = 0; i < samples.length - 1; i++) {
                    const current = samples[i];
                    const next = samples[i + 1];
                    
                    // Draw horizontal line at current sample value
                    ctx.moveTo(current.x, current.y);
                    ctx.lineTo(next.x, current.y);
                    
                    // Draw vertical line to next sample
                    if (i < samples.length - 1) {
                        ctx.moveTo(next.x, current.y);
                        ctx.lineTo(next.x, next.y);
                    }
                }
                ctx.stroke();
                
                // Legend is now displayed above the canvas
                // this.drawLegend();
            }
            
            drawGrid() {
                const ctx = this.ctx;
                const width = this.canvas.width;
                const height = this.canvas.height;
                
                ctx.strokeStyle = '#e2e8f0';
                ctx.lineWidth = 1;
                
                // Vertical lines
                for (let x = 0; x < width; x += 50) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, height);
                    ctx.stroke();
                }
                
                // Horizontal lines
                for (let y = 0; y < height; y += 50) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(width, y);
                    ctx.stroke();
                }
            }
            
            drawLegend() {
                const ctx = this.ctx;
                const width = this.canvas.width;
                const height = this.canvas.height;
                
                // Legend background - positioned in top-right corner
                ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
                ctx.fillRect(width - 180, 10, 170, 70);
                ctx.strokeStyle = '#e2e8f0';
                ctx.lineWidth = 1;
                ctx.strokeRect(width - 180, 10, 170, 70);
                
                // Legend title
                ctx.fillStyle = '#2d3748';
                ctx.font = 'bold 11px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('Signal Legend', width - 170, 25);
                
                // Blue line legend
                ctx.strokeStyle = '#2b6cb0';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(width - 170, 40);
                ctx.lineTo(width - 150, 40);
                ctx.stroke();
                ctx.fillStyle = '#2d3748';
                ctx.font = '10px Arial';
                ctx.fillText('Analog Signal', width - 150, 45);
                
                // Red dots legend
                ctx.fillStyle = '#e53e3e';
                ctx.beginPath();
                ctx.arc(width - 170, 58, 2.5, 0, 2 * Math.PI);
                ctx.fill();
                ctx.fillStyle = '#2d3748';
                ctx.fillText('Sample Points', width - 150, 62);
                
                // Green steps legend
                ctx.strokeStyle = '#38a169';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(width - 170, 75);
                ctx.lineTo(width - 150, 75);
                ctx.stroke();
                ctx.fillStyle = '#2d3748';
                ctx.fillText('Digital Output', width - 150, 80);
            }
        }
        
        // DAC Visualizer
        class DACVisualizer {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.digitalSignal = '101010';
                this.reconstructionType = 'basic';
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.draw();
            }
            
            setupEventListeners() {
                const signalInput = document.getElementById('dac-signal');
                const reconstructionSelect = document.getElementById('dac-reconstruction');
                
                signalInput.addEventListener('input', (e) => {
                    this.digitalSignal = e.target.value.replace(/[^01]/g, '');
                    e.target.value = this.digitalSignal;
                    this.draw();
                });
                
                reconstructionSelect.addEventListener('change', (e) => {
                    this.reconstructionType = e.target.value;
                    this.draw();
                });
            }
            
            draw() {
                const ctx = this.ctx;
                const width = this.canvas.width;
                const height = this.canvas.height;
                const centerY = height / 2;
                
                // Clear canvas
                ctx.clearRect(0, 0, width, height);
                
                // Draw grid
                this.drawGrid();
                
                if (this.digitalSignal.length === 0) return;
                
                const bitWidth = width / this.digitalSignal.length;
                const bitHeight = 60;
                
                // Draw digital signal bars
                ctx.fillStyle = '#2b6cb0';
                for (let i = 0; i < this.digitalSignal.length; i++) {
                    const bit = this.digitalSignal[i];
                    const x = i * bitWidth;
                    const y = centerY - bitHeight / 2;
                    
                    if (bit === '1') {
                        ctx.fillRect(x, y, bitWidth, bitHeight);
                    }
                    
                    // Draw bit labels
                    ctx.fillStyle = '#ffffff';
                    ctx.font = '14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(bit, x + bitWidth / 2, centerY + 5);
                    ctx.fillStyle = '#2b6cb0';
                }
                
                // Draw analog reconstruction
                ctx.strokeStyle = '#e53e3e';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                if (this.reconstructionType === 'basic') {
                    this.drawBasicReconstruction(bitWidth, bitHeight, centerY);
                } else {
                    this.drawFilteredReconstruction(bitWidth, bitHeight, centerY);
                }
            }
            
            drawBasicReconstruction(bitWidth, bitHeight, centerY) {
                const ctx = this.ctx;
                const width = this.canvas.width;
                
                for (let i = 0; i < this.digitalSignal.length; i++) {
                    const bit = this.digitalSignal[i];
                    const x = i * bitWidth;
                    const y = centerY + (bit === '1' ? -bitHeight / 2 : bitHeight / 2);
                    
                    if (i === 0) {
                        ctx.moveTo(0, y);
                    }
                    
                    // Horizontal line at current level
                    ctx.lineTo(x + bitWidth, y);
                    
                    // Vertical line to next level (if not last bit)
                    if (i < this.digitalSignal.length - 1) {
                        const nextBit = this.digitalSignal[i + 1];
                        const nextY = centerY + (nextBit === '1' ? -bitHeight / 2 : bitHeight / 2);
                        ctx.lineTo(x + bitWidth, nextY);
                    }
                }
                ctx.stroke();
            }
            
            drawFilteredReconstruction(bitWidth, bitHeight, centerY) {
                const ctx = this.ctx;
                const width = this.canvas.width;
                
                ctx.beginPath();
                ctx.moveTo(0, centerY);
                
                for (let i = 0; i < this.digitalSignal.length; i++) {
                    const bit = this.digitalSignal[i];
                    const x = i * bitWidth;
                    const y = centerY + (bit === '1' ? -bitHeight / 2 : bitHeight / 2);
                    
                    // Smooth curve to current level
                    const controlX1 = x - bitWidth * 0.3;
                    const controlX2 = x + bitWidth * 0.3;
                    
                    ctx.quadraticCurveTo(controlX1, centerY, x, y);
                    ctx.quadraticCurveTo(controlX2, y, x + bitWidth, y);
                }
                
                // Smooth curve to center at the end
                const endX = width;
                ctx.quadraticCurveTo(endX - bitWidth * 0.3, centerY, endX, centerY);
                ctx.stroke();
            }
            
            drawGrid() {
                const ctx = this.ctx;
                const width = this.canvas.width;
                const height = this.canvas.height;
                
                ctx.strokeStyle = '#e2e8f0';
                ctx.lineWidth = 1;
                
                // Vertical lines
                for (let x = 0; x < width; x += 50) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, height);
                    ctx.stroke();
                }
                
                // Horizontal lines
                for (let y = 0; y < height; y += 50) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(width, y);
                    ctx.stroke();
                }
            }
        }
        
        // Initialize tools when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new ADCVisualizer('adc-canvas');
            new DACVisualizer('dac-canvas');
        });
    </script>
</body>
</html>
